"use strict";const sectionAnime=document.querySelector(".js-section"),inputUser=document.querySelector(".js-input"),searchButton=document.querySelector(".js-btn-search"),asideFavsElement=document.querySelector(".js-favanime"),resetButton=document.querySelector(".js-btn-reset"),resetButtonFav=document.querySelector(".js-btn-reset-fav");let animeList=[],favAnimeList=[];const getApiFromSearch=()=>{fetch("https://api.jikan.moe/v3/search/anime?q="+inputUser.value).then(e=>e.json()).then(e=>{sectionAnime.innerHTML="";const t=e.results;animeList=t,replaceImage(),renderAll(animeList)})},replaceImage=()=>{for(let e=0;e<animeList.length;e++)void 0===animeList.image_url&&(animeList[e].image_url=animeList[e].image_url.replace("https://cdn.myanimelist.net/images/qm_50.gif?s=e1ff92a46db617cb83bfc1e205aff620","https://via.placeholder.com/210x295/ffffff/666666/"))},renderOne=e=>{let t=favAnimeList.find(t=>t.id===e.mal_id);sectionAnime.innerHTML+=void 0===t?`\n              <article class="main__article " data-id="${e.mal_id}">\n                <img class="main__article--image" src="${e.image_url}" alt="image-of-anime">\n                <p class="main__article--title">${e.title}</p>\n                </article>`:`\n              <article class="main__article fav" data-id="${e.mal_id}">\n                <img class="main__article--image" src="${e.image_url}" alt="image-of-anime">\n                <p class="main__article--title">${e.title}</p>\n                </article>`},renderAll=e=>{sectionAnime.innerHTML="";for(let t=0;t<e.length;t++)renderOne(e[t]);listenArticle()},getFavAnimesCode=e=>{let t="";return t+=`<article class="main__article--fav favorites">\n    <img class="main__article--image favorites " src="${e.image}" alt="image-of-anime">\n    <p class="main__article--title ">${e.title}</p>\n    <input class="js-btn-delete main__article--dltbtn" data-id="${e.id}" type="button" value="X"></article>`,t},paintFavAnimes=()=>{asideFavsElement.innerHTML="";for(const e of favAnimeList)asideFavsElement.innerHTML+=getFavAnimesCode(e);listenDeleteButtons()};function favAnimeStyle(e){e.currentTarget.classList.toggle("fav"),addFavToList(e)}function addFavToList(e){const t=e.currentTarget.dataset.id,i=parseInt(t);if(void 0===favAnimeList.find(e=>e.id===i)){let e=animeList.find(e=>e.mal_id===i);favAnimeList.push({id:e.mal_id,title:e.title,image:e.image_url})}else{const t=e.currentTarget.dataset.id,i=parseInt(t);let n=favAnimeList.findIndex(e=>e.id===i);favAnimeList.splice(n,1)}setLocalStorage(),paintFavAnimes()}function resetAll(){inputUser.value="",sectionAnime.innerHTML=""}function deleteFavAnime(e){const t=e.currentTarget.dataset.id,i=parseInt(t);let n=favAnimeList.findIndex(e=>e.id===i);favAnimeList.splice(n,1),renderAll(animeList),setLocalStorage(),paintFavAnimes()}function resetAllFav(){favAnimeList=[],asideFavsElement.innerHTML="",localStorage.clear(),renderAll(animeList)}function listenDeleteButtons(){listenClickEvents(".js-btn-delete",deleteFavAnime)}function listenArticle(){listenClickEvents(".main__article",favAnimeStyle)}const listenClickEvents=(e,t)=>{const i=document.querySelectorAll(e);for(const e of i)e.addEventListener("click",t)},getFromLocalStorage=()=>{const e=localStorage.getItem("favoriteAnime");null!==e&&(favAnimeList=JSON.parse(e),paintFavAnimes())},setLocalStorage=()=>{const e=JSON.stringify(favAnimeList);localStorage.setItem("favoriteAnime",e)};searchButton.addEventListener("click",getApiFromSearch),resetButton.addEventListener("click",resetAll),resetButtonFav.addEventListener("click",resetAllFav),getFromLocalStorage(),paintFavAnimes();